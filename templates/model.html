{% extends "base.html" %}

{% block title %}Model - ThyroPredict{% endblock %}

{% block content %}
<section class="page-header">
    <div class="container">
        <h1>üß† Our Machine Learning Model</h1>
        <p class="subtitle">Ensemble approach combining SVM, Random Forest, and Gradient Boosting for accurate thyroid prediction</p>
    </div>
</section>

<!-- Model Architecture Section -->
<section class="content-section">
    <div class="container">
        <h2>üîß Model Architecture</h2>
        <p class="section-subtitle">Ensemble approach using multiple machine learning algorithms</p>
        <div class="model-diagram">
            <div class="architecture-box">
                <h3>üì• Input Features (15 total)</h3>
                <ul>
                    <li><strong>Demographics:</strong> Age, Gender, Pregnancy Status</li>
                    <li><strong>TSH:</strong> Thyroid Stimulating Hormone</li>
                    <li><strong>T3:</strong> Triiodothyronine level</li>
                    <li><strong>TT4:</strong> Total Thyroxine level</li>
                    <li><strong>T4U:</strong> T4 Uptake percentage</li>
                    <li><strong>FTI:</strong> Free Thyroxine Index</li>
                    <li><strong>TBG:</strong> Thyroid Binding Globulin</li>
                    <li><strong>Test Status:</strong> Whether each test was performed</li>
                </ul>
            </div>
            <div class="arrow">‚Üí</div>
            <div class="architecture-box">
                <h3>‚öôÔ∏è Soft Ensemble (5 Models)</h3>
                <ul>
                    <li><strong>Random Forest</strong> (200 trees)</li>
                    <li><strong>XGBoost</strong> (200 iterations)</li>
                    <li><strong>Gradient Boosting</strong> (200 estimators)</li>
                    <li><strong>SVM</strong> (RBF kernel)</li>
                    <li><strong>Logistic Regression</strong> (baseline)</li>
                </ul>
            </div>
            <div class="arrow">‚Üí</div>
            <div class="architecture-box">
                <h3>üì§ Predictions</h3>
                <ul>
                    <li><strong>Diagnosis:</strong> Negative, Hypo, or Hyper</li>
                    <li><strong>Confidence:</strong> Percentage (0-100%)</li>
                    <li><strong>Probabilities:</strong> Risk % for each condition</li>
                    <li><strong>Model Type:</strong> Soft Ensemble identifier</li>
                </ul>
            </div>
        </div>
    </div>
</section>

<!-- ML Models Details Section -->
<section class="algorithm-details">
    <div class="container">
        <h2>ü§ñ Machine Learning Models</h2>
        <div class="algorithms-list">
            <div class="algorithm-item">
                <div class="algorithm-icon">üéØ</div>
                <h3>Support Vector Machine (SVM)</h3>
                <p><strong>Why SVM:</strong> Excellent for binary and multi-class classification. Finds optimal decision boundaries that maximize the margin between classes. Particularly effective with the non-linear hormone interactions in thyroid data.</p>
                <p><strong>Implementation:</strong> RBF (Radial Basis Function) kernel with C=1.0, gamma='scale', probability=True for probability estimates. Achieves 94.60% accuracy. Handles high-dimensional feature space efficiently.</p>
            </div>
            <div class="algorithm-item">
                <div class="algorithm-icon">üå≤</div>
                <h3>Random Forest</h3>
                <p><strong>Why Random Forest:</strong> Ensemble of decision trees that provides robust predictions and handles missing data gracefully. Provides feature importance rankings which help identify the most critical clinical markers.</p>
                <p><strong>Implementation:</strong> 200 trees with max_depth=15, min_samples_split=5, min_samples_leaf=2. Achieves 98.18% accuracy. Reduces overfitting through random feature selection at each split.</p>
            </div>
            <div class="algorithm-item">
                <div class="algorithm-icon">‚ö°</div>
                <h3>XGBoost</h3>
                <p><strong>Why XGBoost:</strong> Extreme Gradient Boosting is the best performing individual model in our ensemble. Uses advanced regularization techniques to prevent overfitting while maintaining high accuracy.</p>
                <p><strong>Implementation:</strong> 200 boosting iterations with learning_rate=0.1, max_depth=7, subsample=0.8, colsample_bytree=0.8. Achieves 98.24% accuracy - the highest of all individual models.</p>
            </div>
            <div class="algorithm-item">
                <div class="algorithm-icon">üìà</div>
                <h3>Gradient Boosting</h3>
                <p><strong>Why Gradient Boosting:</strong> Sequentially builds weak learners, with each correcting errors of previous ones. Captures complex non-linear relationships and interactions in hormone levels.</p>
                <p><strong>Implementation:</strong> 200 estimators with learning_rate=0.1, max_depth=5, subsample=0.8. Achieves 98.05% accuracy. Provides high accuracy on both training and test data.</p>
            </div>
            <div class="algorithm-item">
                <div class="algorithm-icon">üìä</div>
                <h3>Logistic Regression</h3>
                <p><strong>Why Logistic Regression:</strong> Provides probabilistic predictions directly. Interpretable model that shows how each feature contributes to disease risk. Serves as baseline model for comparison.</p>
                <p><strong>Implementation:</strong> L2 regularization with max_iter=1000 for convergence. Achieves 94.21% accuracy. Features are standardized using StandardScaler before fitting.</p>
            </div>
        </div>
    </div>
</section>

<!-- Performance Metrics Section -->
<section class="performance">
    <div class="container">
        <h2>üìä Model Performance Metrics</h2>
        <div class="metrics-grid">
            <div class="metric-card">
                <h3>Overall Accuracy</h3>
                <p class="metric-value">98.37%</p>
                <p>Soft Ensemble on 1,537 test samples</p>
            </div>
            <div class="metric-card">
                <h3>Precision (Normal)</h3>
                <p class="metric-value">99%</p>
                <p>Correctly identified healthy patients</p>
            </div>
            <div class="metric-card">
                <h3>Recall (Normal)</h3>
                <p class="metric-value">100%</p>
                <p>True negative rate for healthy individuals</p>
            </div>
            <div class="metric-card">
                <h3>Hyper Precision</h3>
                <p class="metric-value">90%</p>
                <p>Hyperthyroidism detection accuracy</p>
            </div>
            <div class="metric-card">
                <h3>Hypo Recall</h3>
                <p class="metric-value">97%</p>
                <p>Hypothyroidism detection rate</p>
            </div>
            <div class="metric-card">
                <h3>F1-Score (Hypo)</h3>
                <p class="metric-value">0.96</p>
                <p>Balanced hypothyroidism performance</p>
            </div>
        </div>
    </div>
</section>

<!-- Model Limitations Section -->
<section class="disclaimers-model">
    <div class="container">
        <h2>‚ö†Ô∏è Model Limitations & Disclaimer</h2>
        <div class="limitations-list">
            <div class="limitation-item">
                <h3>Population Specificity</h3>
                <p>Model trained on specific patient populations. Accuracy may vary in understudied or underrepresented populations.</p>
            </div>
            <div class="limitation-item">
                <h3>Clinical Context</h3>
                <p>Results must be interpreted within individual medical history, medication use, and clinical presentation.</p>
            </div>
            <div class="limitation-item">
                <h3>Data Completeness</h3>
                <p>Model performs optimally with complete hormone panels. Missing data may reduce prediction accuracy.</p>
            </div>
            <div class="limitation-item">
                <h3>Probability Estimates</h3>
                <p>Predictions are risk probabilities, not definitive diagnoses. Always consult healthcare professionals for clinical decisions.</p>
            </div>
            <div class="limitation-item">
                <h3>Not a Replacement</h3>
                <p><strong>This tool is for educational and informational purposes only.</strong> It is NOT a substitute for professional medical advice, diagnosis, or treatment.</p>
            </div>
            <div class="limitation-item">
                <h3>Regulatory Status</h3>
                <p>This is a research tool. For medical decisions, rely on FDA-cleared diagnostic tests and licensed healthcare providers.</p>
            </div>
        </div>
        <div class="disclaimer-highlight">
            <p><strong>Important:</strong> Always seek guidance from qualified healthcare professionals. If you suspect thyroid disease, consult your doctor immediately.</p>
        </div>
    </div>
</section>
{% endblock %}
